<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TableQuest - Tables de multiplication</title>
    <meta
      name="description"
      content="Application ludique pour apprendre les tables de multiplication de 1 Ã  10."
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@500;700&family=Nunito:wght@500;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="bg-shape bg-shape-a"></div>
    <div class="bg-shape bg-shape-b"></div>

    <main class="app">
      <header class="hero card">
        <h1>TableQuest ğŸš€</h1>
        <p class="subtitle">
          Comprendre, s'entraÃ®ner un peu chaque jour, progresser.
        </p>
      </header>

      <nav class="tabs card" aria-label="Navigation principale">
        <button class="tab is-active" data-tab-target="learn">ğŸ“˜ Apprendre</button>
        <button class="tab" data-tab-target="train">ğŸ¯ S'entraÃ®ner</button>
        <button class="tab" data-tab-target="challenge">ğŸ•¹ï¸ Jeu</button>
        <button class="tab" data-tab-target="progress">ğŸ† ProgrÃ¨s</button>
        <button class="tab" data-tab-target="settings">âš™ï¸ Configuration</button>
      </nav>

      <section class="panel card is-active" id="learn" aria-label="Apprendre">
        <div class="panel-head">
          <h2>Apprendre en jouant ğŸ§ </h2>
          <p>Choisis un atelier: lire une table, manipuler des blocs ou dÃ©couvrir le tableau mystÃ¨re.</p>
        </div>

        <div class="learn-mode-switch" role="group" aria-label="Ateliers d'apprentissage">
          <button type="button" class="learn-mode-btn is-active" data-learn-mode="tables">ğŸ“š Les tables</button>
          <button type="button" class="learn-mode-btn" data-learn-mode="blocks">ğŸ§± Les blocs</button>
          <button type="button" class="learn-mode-btn" data-learn-mode="mystery">ğŸ•µï¸ Tableau mystÃ¨re</button>
        </div>

        <section class="learn-subpanel is-active" id="learn-panel-tables" aria-label="Les tables">
          <p class="picker-title">Choisis une table Ã  lire</p>
          <div class="table-keypad" aria-label="Choix de la table Ã  lire">
            <button type="button" class="table-key" data-learn-table="1">1</button>
            <button type="button" class="table-key" data-learn-table="2">2</button>
            <button type="button" class="table-key" data-learn-table="3">3</button>
            <button type="button" class="table-key" data-learn-table="4">4</button>
            <button type="button" class="table-key" data-learn-table="5">5</button>
            <button type="button" class="table-key" data-learn-table="6">6</button>
            <button type="button" class="table-key" data-learn-table="7">7</button>
            <button type="button" class="table-key" data-learn-table="8">8</button>
            <button type="button" class="table-key" data-learn-table="9">9</button>
            <button type="button" class="table-key table-key-ten" data-learn-table="10">10</button>
          </div>

          <div class="equation" id="learn-table-title" aria-live="polite"></div>
          <ul class="table-list" id="learn-list"></ul>
        </section>

        <section class="learn-subpanel" id="learn-panel-blocks" aria-label="Les blocs">
          <p class="picker-title">Choisis une table de blocs</p>
          <div class="table-keypad" aria-label="Choix de la table en blocs">
            <button type="button" class="table-key" data-block-table="1">1</button>
            <button type="button" class="table-key" data-block-table="2">2</button>
            <button type="button" class="table-key" data-block-table="3">3</button>
            <button type="button" class="table-key" data-block-table="4">4</button>
            <button type="button" class="table-key" data-block-table="5">5</button>
            <button type="button" class="table-key" data-block-table="6">6</button>
            <button type="button" class="table-key" data-block-table="7">7</button>
            <button type="button" class="table-key" data-block-table="8">8</button>
            <button type="button" class="table-key" data-block-table="9">9</button>
            <button type="button" class="table-key table-key-ten" data-block-table="10">10</button>
          </div>

          <label class="learn-slider-wrap" for="learn-multiplier-slider">
            Nombre de blocs: <strong id="learn-multiplier-value">4</strong>
            <input id="learn-multiplier-slider" type="range" min="1" max="10" step="1" value="4" />
          </label>

          <div class="equation" id="learn-equation" aria-live="polite"></div>
          <div class="array-grid" id="learn-grid" aria-hidden="true"></div>
        </section>

        <section class="learn-subpanel" id="learn-panel-mystery" aria-label="Tableau mystÃ¨re">
          <p class="picker-title">Clique sur une case pour rÃ©vÃ©ler le rÃ©sultat</p>
          <div class="mystery-board" id="learn-mystery-grid" role="grid" aria-label="Tableau mystÃ¨re des multiplications"></div>
          <button type="button" class="btn btn-ghost mystery-reset-btn" id="learn-mystery-reset">
            Recommencer le tableau mystÃ¨re
          </button>
        </section>
      </section>

      <section class="panel card" id="train" aria-label="S'entraÃ®ner">
        <div class="panel-head">
          <h2>EntraÃ®nement ğŸ¯</h2>
          <p>RÃ©ponds et vois tout de suite la bonne rÃ©ponse.</p>
        </div>

        <div class="train-top">
          <label for="train-filter">
            Table Ã  travailler
            <select id="train-filter">
              <option value="all">Toutes les tables</option>
            </select>
          </label>
          <div class="chip-group">
            <span class="chip" id="train-asked">Questions: 0</span>
            <span class="chip" id="train-correct">RÃ©ussies: 0</span>
          </div>
        </div>

        <div class="question-card">
          <div class="question-line">
            <p class="question" id="train-question">2 x 3 = ?</p>
            <p class="inline-result" id="train-inline-result" aria-live="polite"></p>
          </div>
          <p class="hint">Tape ta rÃ©ponse avec les boutons.</p>
          <form id="train-form">
            <label class="sr-only" for="train-answer">RÃ©ponse</label>
            <input
              id="train-answer"
              type="number"
              inputmode="numeric"
              autocomplete="off"
              readonly
              required
            />
            <button type="submit" class="btn btn-primary">Valider</button>
            <button id="train-next" class="btn btn-ghost" type="button" hidden>
              Suivante
            </button>
          </form>
          <div class="keypad" data-input-id="train-answer" data-form-id="train-form" aria-label="Clavier numÃ©rique">
            <button type="button" class="keypad-key" data-key="1">1</button>
            <button type="button" class="keypad-key" data-key="2">2</button>
            <button type="button" class="keypad-key" data-key="3">3</button>
            <button type="button" class="keypad-key" data-key="4">4</button>
            <button type="button" class="keypad-key" data-key="5">5</button>
            <button type="button" class="keypad-key" data-key="6">6</button>
            <button type="button" class="keypad-key" data-key="7">7</button>
            <button type="button" class="keypad-key" data-key="8">8</button>
            <button type="button" class="keypad-key" data-key="9">9</button>
            <button type="button" class="keypad-key keypad-action" data-action="clear">Effacer</button>
            <button type="button" class="keypad-key" data-key="0">0</button>
          </div>
        </div>
      </section>

      <section class="panel card" id="challenge" aria-label="Jeu">
        <div class="panel-head">
          <h2>Jeu ğŸ•¹ï¸</h2>
          <p>Choisis un type de jeu: dÃ©fi chrono, image mystÃ¨re, tour, boss, combo ou dÃ©fense du chÃ¢teau.</p>
        </div>

        <div class="game-mode-switch" role="group" aria-label="Type de jeu">
          <button type="button" class="mode-btn is-active" id="game-mode-timed">â±ï¸ DÃ©fi chrono</button>
          <button type="button" class="mode-btn" id="game-mode-image">ğŸ–¼ï¸ DÃ©couvre l'image</button>
          <button type="button" class="mode-btn" id="game-mode-tower">ğŸ§± Construit ta tour</button>
          <button type="button" class="mode-btn" id="game-mode-boss">ğŸ‘¾ Boss final</button>
          <button type="button" class="mode-btn" id="game-mode-combo">ğŸ”¥ Combo</button>
          <button type="button" class="mode-btn" id="game-mode-castle">ğŸ° DÃ©fense du chÃ¢teau</button>
        </div>

        <div class="game-visual">
          <div id="timed-game" hidden>
            <p class="game-label">DÃ©fi chrono</p>
            <p class="timed-note">60 secondes pour viser un score de 0 Ã  10000.</p>
          </div>

          <div id="image-game">
            <p class="game-label">Image mystÃ¨re</p>
            <div class="image-reveal">
              <div class="image-grid" aria-hidden="true">
                <span class="image-emoji-cell">ğŸ¶</span>
                <span class="image-emoji-cell">ğŸ±</span>
                <span class="image-emoji-cell">ğŸš—</span>
                <span class="image-emoji-cell">ğŸ¦„</span>
              </div>
              <div class="image-mask" id="image-mask" aria-hidden="true">
                <span class="image-mask-tile"></span>
                <span class="image-mask-tile"></span>
                <span class="image-mask-tile"></span>
                <span class="image-mask-tile"></span>
                <span class="image-mask-tile"></span>
                <span class="image-mask-tile"></span>
                <span class="image-mask-tile"></span>
                <span class="image-mask-tile"></span>
                <span class="image-mask-tile"></span>
                <span class="image-mask-tile"></span>
              </div>
            </div>
          </div>

          <div id="tower-game" hidden>
            <p class="game-label">Ta tour de briques</p>
            <div class="tower-stack" id="tower-stack"></div>
          </div>

          <div id="boss-game" hidden>
            <p class="game-label">Boss final</p>
            <div class="boss-scene">
              <span class="boss-emoji">ğŸ‘¾</span>
              <div class="boss-stats">
                <div class="status-line">
                  <span>Vie du boss</span>
                  <span id="boss-hp-text">12 / 12</span>
                </div>
                <div class="status-bar">
                  <div class="status-bar-fill" id="boss-hp-fill"></div>
                </div>
                <p class="boss-shield" id="boss-shield-text">Bouclier: 3 / 3</p>
              </div>
            </div>
          </div>

          <div id="combo-game" hidden>
            <p class="game-label">Combo</p>
            <div class="combo-scene">
              <p class="combo-value" id="combo-value">Combo x0</p>
              <div class="status-bar combo-bar">
                <div class="status-bar-fill combo-fill" id="combo-fill"></div>
              </div>
              <p class="combo-best" id="combo-best">Meilleur combo: 0</p>
            </div>
          </div>

          <div id="castle-game" hidden>
            <p class="game-label">DÃ©fense du chÃ¢teau</p>
            <div class="castle-difficulty" role="group" aria-label="DifficultÃ© du chÃ¢teau">
              <button type="button" class="castle-difficulty-btn" data-castle-difficulty="easy">Facile</button>
              <button type="button" class="castle-difficulty-btn is-active" data-castle-difficulty="normal">Normal</button>
              <button type="button" class="castle-difficulty-btn" data-castle-difficulty="hard">Difficile</button>
            </div>
            <div class="castle-scene">
              <div class="status-line">
                <span>Vagues dÃ©fendues</span>
                <span id="castle-wave-text">0 / 3</span>
              </div>
              <p class="castle-wave-detail" id="castle-wave-detail">Vague 1: 0 / 3</p>
              <p class="castle-incoming" id="castle-incoming">Ennemis restants: 0</p>
              <div class="castle-track-wrap">
                <span class="castle-side-icon">âš”ï¸</span>
                <div class="castle-track" id="castle-track" aria-label="Piste des ennemis"></div>
                <span class="castle-side-icon">ğŸ°</span>
              </div>
              <p class="castle-lives" id="castle-lives">Vies du chÃ¢teau: 4 / 4</p>
              <p class="castle-fx" id="castle-fx" aria-live="polite"></p>
            </div>
          </div>
        </div>

        <div class="challenge-head">
          <button class="btn btn-primary" id="challenge-start">DÃ©marrer le dÃ©fi</button>
          <div class="chip-group">
            <span class="chip" id="challenge-timer">Progression: 0 / 10</span>
            <div
              class="timer-gauge"
              id="challenge-timer-gauge"
              hidden
              role="progressbar"
              aria-label="Temps restant"
              aria-valuemin="0"
              aria-valuemax="60"
              aria-valuenow="60"
            >
              <div class="timer-gauge-fill" id="challenge-timer-fill"></div>
            </div>
            <span class="chip" id="challenge-score">Score: 0 pts</span>
          </div>
        </div>

        <div class="question-card">
          <div class="question-line">
            <p class="question" id="challenge-question">DÃ©fi chrono: appuie sur "DÃ©marrer le dÃ©fi".</p>
            <p class="inline-result" id="challenge-inline-result" aria-live="polite"></p>
          </div>
          <p class="hint">Tape ta rÃ©ponse avec les boutons.</p>
          <form id="challenge-form">
            <label class="sr-only" for="challenge-answer">RÃ©ponse</label>
            <input
              id="challenge-answer"
              type="number"
              inputmode="numeric"
              autocomplete="off"
              readonly
              disabled
              required
            />
            <button type="submit" class="btn btn-primary" disabled id="challenge-submit">
              Valider
            </button>
          </form>
          <div
            class="keypad"
            data-input-id="challenge-answer"
            data-form-id="challenge-form"
            aria-label="Clavier numÃ©rique"
          >
            <button type="button" class="keypad-key" data-key="1">1</button>
            <button type="button" class="keypad-key" data-key="2">2</button>
            <button type="button" class="keypad-key" data-key="3">3</button>
            <button type="button" class="keypad-key" data-key="4">4</button>
            <button type="button" class="keypad-key" data-key="5">5</button>
            <button type="button" class="keypad-key" data-key="6">6</button>
            <button type="button" class="keypad-key" data-key="7">7</button>
            <button type="button" class="keypad-key" data-key="8">8</button>
            <button type="button" class="keypad-key" data-key="9">9</button>
            <button type="button" class="keypad-key keypad-action" data-action="clear">Effacer</button>
            <button type="button" class="keypad-key" data-key="0">0</button>
          </div>
        </div>

        <div class="leaderboard" id="leaderboard-wrap" hidden>
          <div class="leaderboard-head">
            <h3>Leaderboard â±ï¸</h3>
            <button type="button" class="btn btn-ghost" id="leaderboard-clear">Vider</button>
          </div>
          <ol class="leaderboard-list" id="leaderboard-list"></ol>
        </div>
      </section>

      <section class="panel card" id="progress" aria-label="ProgrÃ¨s">
        <div class="panel-head">
          <h2>Ton suivi ğŸ†</h2>
          <p>Ce que tu sais bien, et ce qu'il faut revoir.</p>
        </div>

        <div class="stats-grid">
          <article class="stat">
            <h3>RÃ©ussite globale</h3>
            <p id="stat-accuracy">0%</p>
          </article>
          <article class="stat">
            <h3>OpÃ©rations maÃ®trisÃ©es</h3>
            <p id="stat-mastered">0 / 100</p>
          </article>
          <article class="stat">
            <h3>Ã€ revoir aujourd'hui</h3>
            <p id="stat-due">0</p>
          </article>
        </div>

        <div class="progress-layout">
          <div>
            <h3>Carte des opÃ©rations (a x b)</h3>
            <div class="heatmap" id="heatmap"></div>
          </div>
          <div>
            <h3>Les plus difficiles</h3>
            <ol id="weak-facts" class="weak-list"></ol>
          </div>
        </div>
      </section>

      <section class="panel card" id="settings" aria-label="Configuration">
        <div class="panel-head">
          <h2>Configuration âš™ï¸</h2>
          <p>Choisis les tables Ã  entraÃ®ner et gÃ¨re tes sauvegardes.</p>
        </div>

        <div class="settings-block">
          <h3>1. Tables actives</h3>
          <p class="settings-text">Ces tables seront utilisÃ©es dans S'entraÃ®ner et Jeu.</p>
          <div class="table-toggle-grid" id="settings-table-grid" aria-label="Tables actives">
            <button type="button" class="table-toggle" data-config-table="1">Table de 1</button>
            <button type="button" class="table-toggle" data-config-table="2">Table de 2</button>
            <button type="button" class="table-toggle" data-config-table="3">Table de 3</button>
            <button type="button" class="table-toggle" data-config-table="4">Table de 4</button>
            <button type="button" class="table-toggle" data-config-table="5">Table de 5</button>
            <button type="button" class="table-toggle" data-config-table="6">Table de 6</button>
            <button type="button" class="table-toggle" data-config-table="7">Table de 7</button>
            <button type="button" class="table-toggle" data-config-table="8">Table de 8</button>
            <button type="button" class="table-toggle" data-config-table="9">Table de 9</button>
            <button type="button" class="table-toggle" data-config-table="10">Table de 10</button>
          </div>
          <p class="settings-text" id="settings-active-summary"></p>
        </div>

        <div class="settings-block">
          <h3>2. Affichage du jeu</h3>
          <p class="settings-text">Sur grand Ã©cran, place le visuel du jeu Ã  gauche ou Ã  droite du clavier.</p>
          <div class="handedness-toggle" role="group" aria-label="Position du visuel">
            <button type="button" class="table-toggle" id="settings-visual-left">Visuel Ã  gauche</button>
            <button type="button" class="table-toggle" id="settings-visual-right">Visuel Ã  droite (gaucher)</button>
          </div>
        </div>

        <div class="settings-block">
          <h3>3. Exporter et importer les rÃ©sultats</h3>
          <p class="settings-text">
            Conseil: exporte en fichier JSON. Tu peux aussi prÃ©parer un email.
          </p>
          <div class="settings-actions">
            <button type="button" class="btn btn-primary" id="settings-export-file">Exporter en fichier</button>
            <button type="button" class="btn btn-ghost" id="settings-export-email">PrÃ©parer un email</button>
            <button type="button" class="btn btn-ghost" id="settings-import-btn">Importer un fichier</button>
            <input id="settings-import-input" type="file" accept="application/json" hidden />
          </div>
        </div>

        <div class="settings-block settings-danger">
          <h3>4. Remettre Ã  zÃ©ro</h3>
          <p class="settings-text">
            Efface tous les rÃ©sultats et remet la configuration par dÃ©faut.
          </p>
          <button type="button" class="btn btn-danger" id="settings-reset-btn">Remettre Ã  zÃ©ro</button>
        </div>

        <p class="settings-status" id="settings-status" aria-live="polite"></p>
      </section>
    </main>
    <div id="celebration-layer" class="celebration-layer" aria-live="polite" aria-atomic="true"></div>
    <div id="castle-danger-layer" class="castle-danger-layer" aria-hidden="true"></div>

    <script src="./app.js"></script>
  </body>
</html>
